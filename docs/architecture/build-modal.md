# 建模

## 4+1 视图模型

### 1. 逻辑视图

描述软件的功能逻辑，由哪些模块组成，模块中包含哪些类，其依赖关系如何

### 2. 开发视图

- 包括系统架构层面的层次划分，包的管理，依赖的系统与第三方的程序包。
- 开发视图某些方面与逻辑视图有一定重复性，不同视角看到的可能是同一个东西，开发视图中的一个程序包，可能正好对应逻辑视图中的一个功能模块

### 3. 过程视图

- 描述程序运行期的进程、线程、对象实例，以及于此相关的并发、同步、通信等问题

### 4. 物理视图

- 描述软件如何安装并部署到物理的服务上，以及不同的服务器之间如何关联、通信

### 5. 场景视图

- 针对具体的用例场景，将上述 4 个视图关联起来，一方面从业务角度描述，功能流程如何完成，一方面从软件角度描述，相关组成部分如何互相依赖、调用

## 常用的 7 个 UML 模型图

1. 类图
2. 时序图
3. 组件图：比类的粒度更大的设计元素，有时候和包图的用途比较接近，通常用来描述物理上的组件，如一个 JAR 包，一个 dll
4. 部署图
5. 用例图
6. 状态图：展示单个对象生命周期的状态变迁
7. 活动图：主要用来描述过程逻辑和业务逻辑。UML 中没有流程图，通常用活动图替代流程图

## 软件设计的不同阶段

### 1. 需求分析阶段

1. 主要通过用例图来描述系统的功能和使用场景
2. 对于关键的业务流程，可以通过活动图描述
3. 如果在需求阶段就提出要和现有的某个子系统整合，那么可以通过时序图描述新系统和原来的子系统的调用关系
4. 可以通过简化的类图进行领域模型抽象，并描述核心领域对象之间的关系
5. 如果某些对象内部会有复杂的状态变化，比如用户、订单这些，可以用状态图进行描述

### 2. 概要设计阶段

1. 通过部署图描述系统最终的物理蓝图
2. 通过组件图以及组件时序图设计软件主要模块及其关系
3. 还可以通过组件的活动图描述组件间的流程逻辑

### 3. 详细设计阶段

1. 主要输出的就是类图和类的时序图，指导最终的代码开发
2. 如何某个类方法内部有比较复杂的逻辑，可以用画方法的活动图进行描述

## UML 中定义 6 种类与类之间的交互关系

- 分类过于细，也可以把`聚合、组合、依赖`合并为一种类型`组合`。这样和`多用组合少用继承`中的组合概念保持一致，只要 B 类对象是 A 类对象的成员变量，我们就说这是组合关系

### 1. 泛化

- 类之间的继承

### 2. 实现

- 类继承接口

### 3. 聚合

- A 包含 B，但 B 的生命周期不依赖 A，B 是外部创建后传入给 A

### 4. 组合

- A 包含 B，B 在 A 中创建，和 A 的生命周期一致

### 5. 关联

- 是一种非常弱的关系，包含了聚合和组合两种关系

### 6. 依赖

- 比关联更弱的关系，包含关联关系，无论 B 在 A 中是成员变量，还是 A 中方法使用 B 类对象作为参数或者返回值，局部变量。只要有任何的使用关系，都是依赖
