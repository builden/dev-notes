# http https http2

## http1.1

- http 头部不参与 gzip 压缩，只有消息体会压缩

## https

### 流程

1. 客户端发送一条带随机串 A 的协议
2. 服务端返回数字证书，并带上用私钥加密了的随机串 B
3. 客户端用公钥生成一个随机串 C 发送给服务器，并在本地根据随机串 ABC 生成对称秘钥
4. 服务器使用私钥解密后也拿到随机串 C，并在服务端根据随机串 ABC 生成同样的对称秘钥

## http2

- 自带 SSL 加密
- 只需要一个连接，减少了 TCP 慢启动的问题
- 流式传输，可以同时发多个请求
- 服务器可以根据请求优先级优先传输关键数据
- 长连接，无需 websocket
- 头部压缩

## http3

- 基于 udp，减少了握手的过程
- 解决了 http2 因为弱网环境下丢包后导致整个请求阻塞的问题

## gzip VS brotli

- brotli 的压缩效率高 20%左右
- brotli 只支持 https
- brotli 在移动端也有很好的支持
